<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>å£²ä¸Šãƒ»é€é‡‘ãƒ•ã‚©ãƒ¼ãƒ </title>

  <!-- STUDIOå¯„ã‚Šã®ãƒ•ã‚©ãƒ³ãƒˆï¼ˆè¿‘ä¼¼ï¼‰ -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">

  <style>
    :root{
      /* ã“ã“ã‚’èª¿æ•´ã™ã‚‹ã¨ä¸€æ°—ã«ä¼¼ã›ã‚„ã™ã„ */
      --page-bg: #f6f7f8;
      --card-bg: #ffffff;
      --text: #111827;
      --muted: #6b7280;
      --border: rgba(17,24,39,.12);
      --input-bg: #ffffff;
      --input-border: rgba(17,24,39,.18);
      --focus: rgba(59,130,246,.25);

      --radius-card: 20px;
      --radius-input: 14px;
      --radius-btn: 16px;

      --shadow-card: 0 12px 40px rgba(17,24,39,.10);
      --shadow-input: 0 1px 0 rgba(17,24,39,.06);

      --w: 375px;
    }

    html,body{ height:100%; }
    body{
      margin:0;
      color:var(--text);
      background: var(--page-bg);
      font-family: Inter, "Noto Sans JP", system-ui, -apple-system, "Hiragino Kaku Gothic ProN", sans-serif;
    }

    .wrap{
      max-width: var(--w);
      margin: 0 auto;
      padding: 16px 14px 24px;
    }

    .title{
      font-size: 16px;
      font-weight: 700;
      letter-spacing: .2px;
      margin: 6px 2px 12px;
    }

    .card{
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: var(--radius-card);
      box-shadow: var(--shadow-card);
      padding: 14px;
    }

    .section{
      margin-top: 12px;
    }
    .section:first-child{ margin-top: 0; }

    .secTitle{
      font-size: 12px;
      font-weight: 700;
      color: var(--muted);
      letter-spacing: .4px;
      margin: 10px 2px 8px;
      text-transform: none;
    }

    .field{
      display:flex;
      flex-direction:column;
      gap:6px;
      margin-bottom: 10px;
    }

    label{
      font-size: 12px;
      font-weight: 600;
      color: rgba(17,24,39,.82);
    }

    input, select, textarea{
      width:100%;
      box-sizing:border-box;
      font-size: 14px;
      padding: 11px 12px;
      background: var(--input-bg);
      border: 1px solid var(--input-border);
      border-radius: var(--radius-input);
      box-shadow: var(--shadow-input);
      outline: none;
    }

    input:focus, select:focus, textarea:focus{
      border-color: rgba(59,130,246,.55);
      box-shadow: 0 0 0 4px var(--focus);
    }

    textarea{
      min-height: 78px;
      resize: vertical;
    }

    .helper{
      font-size: 12px;
      color: var(--muted);
      margin: 6px 2px 0;
      line-height: 1.4;
    }

    .btns{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 12px;
    }
    .btns.one{ grid-template-columns: 1fr; }

    button{
      width:100%;
      border: 0;
      border-radius: var(--radius-btn);
      padding: 12px 12px;
      font-size: 14px;
      font-weight: 700;
      cursor:pointer;
    }
    .primary{
      background: #111827;
      color: #fff;
      box-shadow: 0 10px 24px rgba(17,24,39,.22);
    }
    .ghost{
      background: rgba(17,24,39,.06);
      color: #111827;
    }

    .hide{ display:none; }

    /* ç¢ºèªç”»é¢ï¼ˆã‚¹ã‚¯ã‚·ãƒ§1æšã«åã‚ã‚‹ãŸã‚å¯†åº¦é«˜ã‚ï¼‰ */
    .kvs{ margin-top: 6px; }
    .line{
      display:flex;
      justify-content:space-between;
      gap: 10px;
      padding: 6px 0;
      border-bottom: 1px dashed rgba(17,24,39,.10);
      font-size: 13px;
    }
    .line:last-child{ border-bottom:0; }
    .mono{ font-variant-numeric: tabular-nums; }
    .ellipsis2{
      text-align:right;
      overflow:hidden;
      display:-webkit-box;
      -webkit-line-clamp:2;
      -webkit-box-orient:vertical;
    }

    .msg{
      margin-top: 10px;
      padding: 10px 12px;
      border-radius: 14px;
      font-size: 13px;
      line-height: 1.4;
      border: 1px solid rgba(17,24,39,.12);
      background: rgba(255,255,255,.75);
    }
    .ok{ border-color: rgba(34,197,94,.25); background: rgba(34,197,94,.07); }
    .err{ border-color: rgba(239,68,68,.25); background: rgba(239,68,68,.06); }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="title">å£²ä¸Šãƒ»é€é‡‘ãƒ•ã‚©ãƒ¼ãƒ </div>

    <!-- å…¥åŠ› -->
    <div id="stepInput" class="card">
      <div class="field">
        <label>æ°å</label>
        <input id="name" autocomplete="name" placeholder="ä¾‹ï¼šã—ã‚…ã‚“" />
      </div>

      <div class="field">
        <label>å£²ä¸Šæ—¥</label>
        <input id="salesDate" type="date" />
      </div>

      <div class="field">
        <label>ğŸº å£²ä¸Šåº—èˆ—</label>
        <select id="store">
          <option value="" selected>é¸æŠã—ã¦ãã ã•ã„</option>
          <option>ãƒ­ã‚«ãƒ­</option>
          <option>ã‚¤ãƒ¼ã‚¨ãƒƒã‚¯ã‚¹</option>
          <option>ãƒã‚ºãƒ«ãƒ¼ãƒ </option>
          <option>ã†ãŸã®ã»ãé“</option>
          <option>ã‚«ãƒ©ã‚ªã‚±ãƒã‚¹ã‚¿ãƒ¼</option>
        </select>
      </div>

      <div class="secTitle">ğŸ’¹ å£²ä¸Š</div>
      <div class="field"><label>ç¾é‡‘</label><input id="salesCash" inputmode="numeric" placeholder="ä¾‹ï¼š10000" /></div>
      <div class="field"><label>å£²æ›é‡‘/ã‚¯ãƒ¬ã‚«</label><input id="salesCredit" inputmode="numeric" placeholder="ä¾‹ï¼š8000" /></div>
      <div class="field"><label>å£²æ›é‡‘/QR</label><input id="salesQR" inputmode="numeric" placeholder="ä¾‹ï¼š2000" /></div>

      <div class="secTitle">ğŸ‘› çµŒè²»</div>
      <div class="field"><label>ç¾é‡‘</label><input id="expCash" inputmode="numeric" placeholder="ä¾‹ï¼š1200" /></div>
      <div class="field"><label>UPSIDERã‚«ãƒ¼ãƒ‰</label><input id="expUpsider" inputmode="numeric" placeholder="ä¾‹ï¼š3000" /></div>
      <div class="field"><label>ä¸‰äº•ä½å‹ã‚«ãƒ¼ãƒ‰</label><input id="expSMBC" inputmode="numeric" placeholder="ä¾‹ï¼š0" /></div>

      <div class="secTitle">ğŸ¦ é€é‡‘</div>
      <div class="field"><label>é€é‡‘é¡</label><input id="transferAmount" inputmode="numeric" placeholder="ä¾‹ï¼š15800" /></div>
      <div class="field"><label>é€é‡‘æ—¥</label><input id="transferDate" type="date" /></div>
      <div class="field"><label>é€é‡‘å…ˆ</label><input id="transferTo" placeholder="ä¾‹ï¼šGMOã‚ãŠãã‚‰" /></div>
      <div class="field"><label>é€é‡‘ç”³è«‹é¡ï¼ˆä¸è¶³é‡‘ãŒç™ºç”Ÿã—ãŸå ´åˆï¼‰</label><input id="shortageRequest" inputmode="numeric" placeholder="ä¾‹ï¼š2000ï¼ˆãªã‘ã‚Œã°ç©ºæ¬„ï¼‰" /></div>

      <div class="field">
        <label>å‚™è€ƒæ¬„</label>
        <textarea id="note" placeholder="ä¾‹ï¼šæ°·ä»£ã‚’çµŒè²»ã§ç²¾ç®—"></textarea>
      </div>

      <div class="helper">é€ä¿¡å‰ã«ç¢ºèªç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼ˆã‚¹ã‚¯ã‚·ãƒ§1æšæƒ³å®šï¼‰</div>

      <div class="btns one">
        <button class="primary" id="toConfirm">ç¢ºèªç”»é¢ã¸</button>
      </div>

      <div id="inputMsg" class="msg hide"></div>
    </div>

    <!-- ç¢ºèª -->
    <div id="stepConfirm" class="card hide">
      <div class="secTitle">ã€ç¢ºèªã€‘</div>
      <div class="kvs">
        <div class="line"><span>æ°å</span><span class="mono" id="c_name"></span></div>
        <div class="line"><span>å£²ä¸Šæ—¥</span><span class="mono" id="c_salesDate"></span></div>
        <div class="line"><span>åº—èˆ—</span><span id="c_store"></span></div>
      </div>

      <div class="secTitle">ğŸ’¹ å£²ä¸Š</div>
      <div class="kvs">
        <div class="line"><span>ç¾é‡‘</span><span class="mono" id="c_salesCash"></span></div>
        <div class="line"><span>ã‚¯ãƒ¬ã‚«</span><span class="mono" id="c_salesCredit"></span></div>
        <div class="line"><span>QR</span><span class="mono" id="c_salesQR"></span></div>
      </div>

      <div class="secTitle">ğŸ‘› çµŒè²»</div>
      <div class="kvs">
        <div class="line"><span>ç¾é‡‘</span><span class="mono" id="c_expCash"></span></div>
        <div class="line"><span>UPSIDER</span><span class="mono" id="c_expUpsider"></span></div>
        <div class="line"><span>ä¸‰äº•ä½å‹</span><span class="mono" id="c_expSMBC"></span></div>
      </div>

      <div class="secTitle">ğŸ¦ é€é‡‘</div>
      <div class="kvs">
        <div class="line"><span>é€é‡‘é¡</span><span class="mono" id="c_transferAmount"></span></div>
        <div class="line"><span>é€é‡‘æ—¥</span><span class="mono" id="c_transferDate"></span></div>
        <div class="line"><span>é€é‡‘å…ˆ</span><span id="c_transferTo"></span></div>
        <div class="line" id="c_shortageRow"><span>ä¸è¶³é‡‘ç”³è«‹</span><span class="mono" id="c_shortageRequest"></span></div>
        <div class="line"><span>å‚™è€ƒ</span><span class="ellipsis2" id="c_note"></span></div>
      </div>

      <div class="btns">
        <button class="ghost" id="backToEdit">ä¿®æ­£ã™ã‚‹</button>
        <button class="primary" id="submitBtn">é€ä¿¡ã™ã‚‹</button>
      </div>

      <div id="confirmMsg" class="msg hide"></div>
    </div>
  </div>

<script>
  // ========= è¨­å®š =========
  const API_URL = "PASTE_YOUR_GAS_WEBAPP_URL_HERE";
  const API_TOKEN = "CHANGE_ME_TOKEN";

  // ========= ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ =========
  const yen = (n) => "Â¥" + (Number(n||0)).toLocaleString("ja-JP");
  const toNum = (v) => {
    if (v == null) return 0;
    const s = String(v).replace(/[^\d\-]/g, "");
    if (s === "" || s === "-") return 0;
    return Number(s);
  };
  const el = (id) => document.getElementById(id);

  function showMsg(target, ok, text){
    target.classList.remove("hide","ok","err");
    target.classList.add(ok ? "ok" : "err");
    target.textContent = text;
  }
  function hideMsg(target){
    target.classList.add("hide");
    target.textContent = "";
    target.classList.remove("ok","err");
  }

  function collect(){
    return {
      name: el("name").value.trim(),
      salesDate: el("salesDate").value,
      store: el("store").value,

      salesCash: toNum(el("salesCash").value),
      salesCredit: toNum(el("salesCredit").value),
      salesQR: toNum(el("salesQR").value),

      expCash: toNum(el("expCash").value),
      expUpsider: toNum(el("expUpsider").value),
      expSMBC: toNum(el("expSMBC").value),

      transferAmount: toNum(el("transferAmount").value),
      transferDate: el("transferDate").value,
      transferTo: el("transferTo").value.trim(),
      shortageRequest: toNum(el("shortageRequest").value),

      note: el("note").value.trim()
    };
  }

  function validate(d){
    if (!d.name) return "æ°åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„";
    if (!d.salesDate) return "å£²ä¸Šæ—¥ã‚’é¸æŠã—ã¦ãã ã•ã„";
    if (!d.store) return "å£²ä¸Šåº—èˆ—ã‚’é¸æŠã—ã¦ãã ã•ã„";
    return null;
  }

  function fillConfirm(d){
    el("c_name").innerText = d.name;
    el("c_salesDate").innerText = d.salesDate || "â€”";
    el("c_store").innerText = d.store;

    el("c_salesCash").innerText = yen(d.salesCash);
    el("c_salesCredit").innerText = yen(d.salesCredit);
    el("c_salesQR").innerText = yen(d.salesQR);

    el("c_expCash").innerText = yen(d.expCash);
    el("c_expUpsider").innerText = yen(d.expUpsider);
    el("c_expSMBC").innerText = yen(d.expSMBC);

    el("c_transferAmount").innerText = yen(d.transferAmount);
    el("c_transferDate").innerText = d.transferDate || "â€”";
    el("c_transferTo").innerText = d.transferTo || "â€”";

    if (d.shortageRequest){
      el("c_shortageRow").style.display = "flex";
      el("c_shortageRequest").innerText = yen(d.shortageRequest);
    } else {
      el("c_shortageRow").style.display = "none";
      el("c_shortageRequest").innerText = "";
    }

    el("c_note").innerText = d.note || "â€”";
  }

  function gotoConfirm(){
    const d = collect();
    const err = validate(d);
    const msg = el("inputMsg");
    hideMsg(msg);
    if (err) return showMsg(msg, false, err);

    fillConfirm(d);
    el("stepInput").classList.add("hide");
    el("stepConfirm").classList.remove("hide");
  }

  function backToEdit(){
    hideMsg(el("confirmMsg"));
    el("stepConfirm").classList.add("hide");
    el("stepInput").classList.remove("hide");
  }

  async function submit(){
    const d = collect();
    const err = validate(d);
    const msg = el("confirmMsg");
    hideMsg(msg);
    if (err) return showMsg(msg, false, err);

    if (!API_URL || API_URL.includes("PASTE_YOUR_GAS_WEBAPP_URL_HERE")){
      return showMsg(msg, false, "API_URL ãŒæœªè¨­å®šã§ã™ï¼ˆGAS Web App URL ã‚’è²¼ã£ã¦ãã ã•ã„ï¼‰");
    }

    const btn = el("submitBtn");
    btn.disabled = true;
    const prev = btn.textContent;
    btn.textContent = "é€ä¿¡ä¸­â€¦";

    try{
      const res = await fetch(API_URL, {
        method: "POST",
        headers: {"Content-Type":"application/json"},
        body: JSON.stringify({ token: API_TOKEN, data: d })
      });
      const json = await res.json().catch(()=> ({}));
      if (!res.ok || json.ok !== true) throw new Error(json.error || "é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸ");

      showMsg(msg, true, "é€ä¿¡å®Œäº†ã—ã¾ã—ãŸã€‚ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚");
    }catch(e){
      showMsg(msg, false, "ã‚¨ãƒ©ãƒ¼ï¼š " + e.message);
    }finally{
      btn.disabled = false;
      btn.textContent = prev;
    }
  }

  el("toConfirm").addEventListener("click", (e)=>{ e.preventDefault(); gotoConfirm(); });
  el("backToEdit").addEventListener("click", (e)=>{ e.preventDefault(); backToEdit(); });
  el("submitBtn").addEventListener("click", (e)=>{ e.preventDefault(); submit(); });
</script>
</body>
</html>
